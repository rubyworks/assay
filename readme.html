
<h1 id="label-Assay">Assay</h1>

<p><a href="http://rubyworks.github.com/assay">Homepage</a> / <a
href="http://github.com/rubyworks/assay">Source Code</a> / <a
href="http://groups.google.com/group/rubyworks-mailinglist">MailingList</a></p>

<h2 id="label-DESCRIPTION">DESCRIPTION</h2>

<p>Assay defines assertions in the same way that Ruby defines exceptions. An
assertion then is nothing more that an extended Exception class. Assay
provides a complete set of these assertion classes for the most common
assertion types. It also provides both TestUnit-style assertion methods and
RSpec-compatiable matchers built from these assertion classes for use in
your preferred test harness. Assay is compatible with TestUnit, MiniTest,
RSpec and other test frameworks.</p>

<h2 id="label-FEATURES">FEATURES</h2>
<ul><li>
<p>Mirrors the Ruby Exception system.</p>
</li><li>
<p>Supports a variety of assertion grammers.</p>
</li><li>
<p>Assertions get their own specialized error messages.</p>
</li></ul>

<h2 id="label-USAGE">USAGE</h2>

<h3 id="label-Assay+Classes">Assay Classes</h3>

<p>Assay consists of a set of Assertion subclasses known as
<strong>assays</strong>. They are akin to Ruby’s Exception subclasses,
indeed the <code>Assertion</code> base class is a subclass of Exception.
But assays have special class methods that are used to make assertions.</p>

<p>Consider the <code>EqualityAssay</code> class. It defines methods for
asserting equality via the `#==` method.</p>

<pre>EqualityAssay.pass!(1,1)</pre>

<p>Or equivalently,</p>

<pre>EqualityAssay.assert(1,1)</pre>

<p>Additionally, we can check the assertion’s test without actually raising
the assertion if it fails using the query method.</p>

<pre class="ruby"><span class="ruby-constant">EqualityAssay</span>.<span class="ruby-identifier">pass?</span>(<span class="ruby-value">1</span>,<span class="ruby-value">1</span>)  <span class="ruby-comment">#=&gt; true</span>
</pre>

<p>Assays also provide the opposite method `#fail!` and alias `#refute`.</p>

<pre>EqualityAssay.fail!(1,2)</pre>

<p>Finally, assay’s can produce matchers using the `#to_matcher` method, or
more conveniently using `#[]`.</p>

<pre>EqualityAssay[1] =~ 1</pre>

<p>Notice in the example we have used `#=~` to apply the matcher which makes
the `#pass!` call to the Assay class. Likewise `#!~` can be used to call
`#fail!` instead. Also note that `#===` is an alias for `#=~`.</p>

<pre>EqualityAssay[1] === 1</pre>

<p>This means assay matchers can be used in case statments.</p>

<pre>case 10
when InstanceAssay[Fixnum]
when EqualityAssay[10.0]
end</pre>

<h3 id="label-Framework+Adapters">Framework Adapters</h3>

<p>Assay follows a standard practice of defining assertion error classes with
an `#assertion?` method that returns <code>true</code>. This can be used by
any test  framework to easily detect when a raise error is an assertion
rather than an ordinary error. To add support for this to common frameworks
Assay provides adapters.</p>

<p>For example, to use assay with MiniTest framework add to your test help
script:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">'assay/adapter/minitest'</span>
</pre>

<p>Likewise for TestUnit.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">'assay/adapter/testunit'</span>
</pre>

<p>An RSpec adadpter is in the works, and should be out with the next release.</p>

<p>Note that even without the adapter, you can use Assay with other these test
frameworks. They will count Assay’s assertions in with errors.</p>

<h3 id="label-Grammers">Grammers</h3>

<p>Of course, the classes are interesting and make an obviously sound 
foundation, but in the end we want to write assertions easily and
concisely. To this, Assay comes with a flexible grammer system which can be
used by requiring any of the prime grammer methods that extend BasicObject.
The most common is probably `should`.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">'assay/grammer/should'</span>

<span class="ruby-value">10</span>.<span class="ruby-identifier">should</span>.<span class="ruby-identifier">be</span>.<span class="ruby-identifier">kind_of</span>(<span class="ruby-constant">Integer</span>)
</pre>

<p>But is you are acustom to MiniTest’s spec methods, you might prefer `must`.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">'assay/grammer/must'</span>

<span class="ruby-value">10</span>.<span class="ruby-identifier">must</span>.<span class="ruby-identifier">be</span>.<span class="ruby-identifier">kind_of</span>(<span class="ruby-constant">Integer</span>)
</pre>

<p>Assay also provides `assert` for techy aficionados like yours truly.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">'assay/grammer/assert'</span>

<span class="ruby-value">10</span>.<span class="ruby-identifier">assert</span>.<span class="ruby-identifier">kind_of</span>(<span class="ruby-constant">Integer</span>)
</pre>

<h3 id="label-Custom+Grammers">Custom Grammers</h3>

<p>Although Assay ships with built-in grammers, there is no reason not to
build your own grammer built on top of on Assay’s classes. Indeed, feel
free to do so! That, after all, is the main purpose of having such a set of
reusable assertion classes! In fact, should it prove common enough, we
might spin-off the grammers as separate projects, leaving Assay to be
essentially a dependecny for other assertion nomenclature libraries.</p>

<h3 id="label-Compatibility+Gems">Compatibility Gems</h3>

<p>Thre are a few spin-off projects that provide compatability modes for
legacy test frameworks which can server as a transitions to Assay from
these other frameworks. Follow the links below for each:</p>
<ul><li>
<p><a href="http://github.com/rubyworks/assay-testunit">TestUnit</a></p>
</li><li>
<p><a href="http://github.com/rubyworks/assay-minitest">MiniTest</a></p>
</li><li>
<p><a href="http://github.com/rubyworks/assay-rspec">RSpec</a></p>
</li></ul>

<p>Usage of essentially the same for any one of them. For example,</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">'assay-rspec'</span>

<span class="ruby-identifier">include</span> <span class="ruby-constant">Assay</span><span class="ruby-operator">::</span><span class="ruby-constant">Matchers</span>

<span class="ruby-value">10</span>.<span class="ruby-identifier">should</span> <span class="ruby-identifier">be_kind_of</span>(<span class="ruby-constant">Integer</span>)
</pre>

<p>Note that the compatibility modules are not yet 100% compatable, lacking
some of the more esoteric and complex features. But they are very nearly
so, and should become more so in time.</p>

<h3 id="label-Learn+More">Learn More</h3>

<p>There’s plently more learn about Assay, mainly the variety of assay classes
available, but also other bits of functionality not comvered here. To learn
about these check out the <a href="http://github.com/rubyworks/assay">QED
documentation</a>, as well as the <a
href="http://rubydoc.info/gems/asasy">API documentation</a>.</p>

<h2 id="label-INSTALLATION">INSTALLATION</h2>

<p>To install with RubyGems simply open a console and type:</p>

<pre>$ gem install assay</pre>

<p>Site installation with the tarball can be done with Ruby Setup (gem install
setup). See <a
href="http://rubyworks.github.com/setup">rubyworks.github.com/setup</a>.</p>

<h2 id="label-COPYRIGHTS">COPYRIGHTS</h2>

<p>Copyright © 2009 Rubyworks</p>

<p>This program is ditributed under the terms of the
<strong>BSD-2-Cluase</strong> license.</p>

<p>See LICENSE.rdoc file for details.</p>
